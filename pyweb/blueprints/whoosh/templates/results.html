{% extends "base.html" %}
{% block content %}
<script>

    function renderResults(column) {
            if (column==="path") {return function(data, type, row, meta) {return '<a href="' + data + '">' + row["title"] + '</a>';}}
            else {return function(data, type, row, meta) {return data;}}
    }

    function table(dom, frame, render, columns) {
        return $(dom).dataTable({
            data: frame.data,
            columns: lobnektable.initColumns(columns, render),
            scrollX: false,
            paging: false
        })
    }

    $(function() {
        $.ajax({
            type: 'GET',
            url: '/api/1/whoosh/index/{{ query }}',
            dataType: "json",

            success: function (response) {
                console.log(response);
                const columns = ["group", "path", "title"];
                table("#table", response, renderResults, columns);
            }
        })
    })
</script>


<div class="container-fluid" style="margin-top:80px">
    <table id="table" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>
</div>
{% endblock %}
